"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const P2cBalancer_1 = require("./P2cBalancer");
test('variation of 10K requests', () => {
    const balancer = new P2cBalancer_1.P2cBalancer(10);
    const bins = new Array(10);
    for (let i = 0; i < bins.length; i++) {
        bins[i] = 0;
    }
    for (let i = 0; i < 1e4; i++) {
        bins[balancer.pick()]++;
    }
    for (const bin of bins) {
        expect(bin / 1e4).toBeCloseTo(0.1, 3);
    }
});
test('overflow', () => {
    const offset = Number.MAX_SAFE_INTEGER - 1;
    const balancer = new P2cBalancer_1.P2cBalancer(2, offset);
    const bins = new Array(2);
    for (let i = 0; i < bins.length; i++) {
        bins[i] = 0;
    }
    for (let i = 0; i < 1e4; i++) {
        bins[balancer.pick()]++;
    }
    for (const bin of bins) {
        expect(bin / 1e4).toBeCloseTo(0.5, 3);
    }
});
//# sourceMappingURL=P2cBalancer.spec.js.map